# raspberypi4
라즈베리파이4 수업 기말대체과제



rp2040에서 x,y,z 3축 가속도를 추출하여 'rp2040' topic으로 text를 보내고
라즈베리파이에서 mqtt브로커가 백그라운드로 돌아가고있는 가운데서 mqtt subscribe 역할을 하는 파이썬 코드로 받아 이를 가공하고
현재 걷는 상태인지 뛰는 상태인지 멈춘 상태인지 판단하고 걸음수를 node-red 게이지로 표시
'ultra' topic으로 이를 보내 또다른 mqtt subscribe역할을 하는 파이썬 코드에서 받아 10초동안 걸음수의 평균을 내어 뛰는 상태인지 걷는 상태인지 멈춘상태인지 판단한다.

rp2040내부의 센서는 
x축 =>  땅과 수평으로 걸어가는 방향의 변화,
y축 =>  진행방향의 옆방향에서의 변화,
z축 =>  수직으로 점프하는 방향으로의 변화를 나타낸다.
사람이 걸을때 평균적으로 x축 변화랑이 가장크고, 양옆으로 조금씩 왔다갔다 하는 변화가 곧 y축의 변화이고,z축이 위아래의 변화인데 
알고리즘으로 구현하려 했더니 약간의 문제가 있다. 
가속도 센서가 걸을때 정확하게 이동하는 방향으로 x축을 측정하는 센서가 향해 있어야 이게 성립한다.
센서를 주머니에 넣고 걸었는데 나는 x축으로 이동하지만 센서 입장에서는 y축으로 이동하는 결과가 될수 있다는것.

3축 가속도 센서중 가장큰 변화량을 가지는 값을 x축으로 삼고, 상대적으로 변화율이 적은 값을 y축, 나머지를 z축으로 삼으면 이를 해결할수있을것 같지만
사람에 따라 보폭도 다르고 위아래로 진동하는것과 양옆으로 이동하는것도 다 달라서 좀더 정확한 알고리즘의 필요성을 느끼고
한영환. (2015). 가속도 센서를 이용한 걸음수 검출 알고리즘.재활복지공학회 논문지 제9권 제3호 . 245-250.https://www.koreascience.or.kr/article/JAKO201515139872162.pdf
위의 논문을 참고해서 걸음수 알고리즘을 작성해 보았다

![3축 가속도 센서](https://user-images.githubusercontent.com/103232943/171842388-c15a1357-d271-4917-84c1-f5800d6bff2a.PNG)
위의 논문에 따르면 3축 가속도에서 나온값으로 SVM이라는 신호 가속도 크기를 구하고

